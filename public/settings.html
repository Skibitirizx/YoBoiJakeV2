<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - YoBoiJake</title>
    <link rel="manifest" href="/manifest.json"/>
    <link rel="icon" id="favicon" type="image/png" href="/assets/images/logo.png">
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <header>
        <img src="/assets/images/logo.png" alt="YoBoiJake Logo">
        <span id="logo-name">YoBoiJake</span>
        <nav>
            <a href="/">Home</a>
            <a href="/games.html">Games</a>
            <a href="/search.html">Search</a>
            <a href="/settings.html">Settings</a>
        </nav>
    </header>

    <main id="settings-content">
        <h1>Tab Cloaking</h1>

        <!-- Cloak Switch Section -->
        <div>
            <label for="cloak-switch">Enable Cloak</label>
            <input type="checkbox" id="cloak-switch" />
        </div>

        <!-- Cloak Buttons Section -->
        <div id="cloaks">
            <button class="cloak-button" onclick="cloakTab('Google Classroom', 'https://ssl.gstatic.com/classroom/favicon.png')">
                <img src="https://ssl.gstatic.com/classroom/favicon.png" alt="Google Classroom Icon">
                Google Classroom
            </button>
            <button class="cloak-button" onclick="cloakTab('Google Docs', 'https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico')">
                <img src="https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico" alt="Google Docs Icon">
                Google Docs
            </button>
            <button class="cloak-button" onclick="cloakTab('Google Drive', 'https://ssl.gstatic.com/docs/doclist/images/drive_2022q3_32dp.png')">
                <img src="https://ssl.gstatic.com/docs/doclist/images/drive_2022q3_32dp.png" alt="Google Drive Icon">
                Google Drive
            </button>
            <button class="cloak-button" onclick="resetTab()">
                <img src="/assets/images/logo.png" alt="Default Icon">
                Reset to Default
            </button>
        </div>
    </main>

    <script>
        // Function to cloak the tab and persist across tabs using localStorage
        function cloakTab(title, favicon) {
            document.title = title;
            const faviconElement = document.getElementById('favicon');
            faviconElement.href = favicon;

            // Save the cloaking settings to localStorage
            localStorage.setItem('cloakTitle', title);
            localStorage.setItem('cloakFavicon', favicon);
        }

        // Function to reset the tab to its original state and clear localStorage
        function resetTab() {
            document.title = 'Settings - YoBoiJake';
            const faviconElement = document.getElementById('favicon');
            faviconElement.href = '/assets/images/logo.png';

            // Reset localStorage
            localStorage.removeItem('cloakTitle');
            localStorage.removeItem('cloakFavicon');
        }

        // Check if cloaking data exists in localStorage and apply it
        window.addEventListener('DOMContentLoaded', () => {
            const savedTitle = localStorage.getItem('cloakTitle');
            const savedFavicon = localStorage.getItem('cloakFavicon');
            const cloakSwitch = document.getElementById('cloak-switch');

            // Check if cloaking was enabled previously and apply it
            if (savedTitle && savedFavicon) {
                document.title = savedTitle;
                const faviconElement = document.getElementById('favicon');
                faviconElement.href = savedFavicon;
                cloakSwitch.checked = true; // Set the checkbox to checked
            }

            // Event listener for the cloak switch
            cloakSwitch.addEventListener('change', () => {
                if (cloakSwitch.checked) {
                    // Enable cloaking when checked
                    const title = localStorage.getItem('cloakTitle');
                    const favicon = localStorage.getItem('cloakFavicon');
                    if (title && favicon) {
                        document.title = title;
                        document.getElementById('favicon').href = favicon;
                    }
                } else {
                    // Reset cloaking if unchecked
                    resetTab();
                }

                // Save the cloak switch state in localStorage
                localStorage.setItem('cloakEnabled', cloakSwitch.checked);
            });

            // Apply the saved cloak state from localStorage
            const cloakEnabled = localStorage.getItem('cloakEnabled') === 'true';
            cloakSwitch.checked = cloakEnabled;

            if (!cloakEnabled) {
                resetTab(); // Reset if cloak is disabled
            }
        });
    </script>
</body>
</html>

